# å›¢é˜Ÿè®°è´¦å’Œç®¡ç†å·¥å…·é¡¹ç›®ä»£ç 

Benork/               # é¡¹ç›®æ ¹ç›®å½•
â”œâ”€â”€ app.py                     # Flask åº”ç”¨å…¥å£
â”œâ”€â”€ config.py                  # é…ç½®æ–‡ä»¶ï¼ˆå¦‚ SECRET_KEYã€æ•°æ®åº“URIï¼‰
â”œâ”€â”€ models.py                  # æ•°æ®æ¨¡å‹å®šä¹‰ï¼ˆUser, Tag, Expenseï¼‰
â”œâ”€â”€ requirements.txt           # é¡¹ç›®ä¾èµ–åˆ—è¡¨
â”œâ”€â”€ auth/                      # èº«ä»½è®¤è¯åŠŸèƒ½æ¨¡å—
â”‚   â”œâ”€â”€ __init__.py            # å®šä¹‰ auth Blueprint
â”‚   â””â”€â”€ routes.py              # æ³¨å†Œã€ç™»å½•ã€ç™»å‡ºè·¯ç”±
â”œâ”€â”€ main/                      # æ™®é€šç”¨æˆ·åŠŸèƒ½æ¨¡å—
â”‚   â”œâ”€â”€ __init__.py            # å®šä¹‰ main Blueprint
â”‚   â””â”€â”€ routes.py              # æäº¤ç”³è¯·ã€æŸ¥çœ‹è‡ªèº«ç”³è¯·è·¯ç”±
â”œâ”€â”€ admin/                     # ç®¡ç†å‘˜åŠŸèƒ½æ¨¡å—
â”‚   â”œâ”€â”€ __init__.py            # å®šä¹‰ admin Blueprint
â”‚   â””â”€â”€ routes.py              # å®¡æ ¸ã€åˆ†ç±»ç®¡ç†ã€ç»Ÿè®¡å¯¼å‡ºè·¯ç”±
â”œâ”€â”€ tutoring/                     
â”‚   â”œâ”€â”€ __init__.py            
â”‚   â””â”€â”€ routes.py
â”œâ”€â”€ templates/                 # å‰ç«¯æ¨¡æ¿
â”‚   â”œâ”€â”€ base.html              # åŸºç¡€é¡µé¢æ¡†æ¶æ¨¡æ¿
â”‚   â”œâ”€â”€ auth/                  # auth æ¨¡å—ç›¸å…³æ¨¡æ¿
â”‚   â”‚   â”œâ”€â”€ login.html         # ç™»å½•é¡µé¢
â”‚   â”‚   â””â”€â”€ register.html      # æ³¨å†Œé¡µé¢
â”‚   â”œâ”€â”€ main/                  # main æ¨¡å—ç›¸å…³æ¨¡æ¿
â”‚   â”‚   â”œâ”€â”€ submit.html        # æäº¤æŠ¥é”€ç”³è¯·é¡µé¢
â”‚   â”‚   â””â”€â”€ my_requests.html   # â€œæˆ‘çš„ç”³è¯·â€é¡µé¢
â”‚   â””â”€â”€ admin/                 # admin æ¨¡å—ç›¸å…³æ¨¡æ¿
â”‚   â”‚   â”œâ”€â”€ pending.html       # å¾…å®¡æ ¸åˆ—è¡¨é¡µé¢
â”‚   â”‚   â”œâ”€â”€ tags.html          # åˆ†ç±»åŠé¢„ç®—ç®¡ç†é¡µé¢
â”‚   â”‚   â””â”€â”€ stats.html         # è´¢åŠ¡ç»Ÿè®¡é¡µé¢
â”‚   â””â”€â”€ tutoring/                 
â”‚       â”œâ”€â”€ admin_pending.html       
â”‚       â”œâ”€â”€ all_records.html          
â”‚       â”œâ”€â”€ feedback.html
â”‚       â”œâ”€â”€ my_records.html          
â”‚       â””â”€â”€ submit.html
â””â”€â”€ static/                    # é™æ€æ–‡ä»¶ç›®å½•ï¼ˆä¿å­˜å›¾è¡¨ç­‰ï¼‰
    â””â”€â”€ ...                    # ä¾‹å¦‚ç”Ÿæˆçš„ç»Ÿè®¡å›¾è¡¨ stats.png


# âœ… Flask å›¢é˜Ÿè®°è´¦å·¥å…·éƒ¨ç½²

## ğŸ“ è·¯å¾„è¯´æ˜ï¼š

- é¡¹ç›®æ ¹ç›®å½•ï¼š`/home/Benork`
- è™šæ‹Ÿç¯å¢ƒç›®å½•ï¼š`/home/Benork/venv`
- ç›‘å¬ç«¯å£ï¼š`5002`

---

## ğŸ§ª æœ¬åœ°è°ƒè¯•è¿è¡Œï¼š

```bash
cd /home/Benork
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt
python app.py
```

æˆ–ç»‘å®šå…¬ç½‘ IPï¼š

```bash
export FLASK_ENV=development
export FLASK_APP=app.py
flask run --host=0.0.0.0 --port=5002
```

---

## ğŸš€ æ­£å¼éƒ¨ç½²æ¨èï¼šGunicorn + systemd

### âœ… å¯åŠ¨ Gunicorn åå°æœåŠ¡ï¼š

```bash
cd /home/Benork
source venv/bin/activate
gunicorn -w 3 -b 0.0.0.0:5002 app:app --daemon
```

### ğŸ›‘ åœæ­¢ gunicornï¼š

```bash
pkill gunicorn
```

---

## ğŸ§° æ·»åŠ  systemd æœåŠ¡æ‰˜ç®¡ï¼š

### 1. åˆ›å»ºæœåŠ¡æ–‡ä»¶

```bash
sudo nano /etc/systemd/system/benork.service
```

ç²˜è´´ä»¥ä¸‹å†…å®¹ï¼š

```ini
[Unit]
Description=Flask Team Accounting Tool (Benork)
After=network.target

[Service]
User=root
WorkingDirectory=/home/Benork
ExecStart=/home/Benork/venv/bin/gunicorn -w 3 -b 0.0.0.0:5002 app:app
Restart=always
Environment=FLASK_ENV=production
Environment=FLASK_APP=app.py

[Install]
WantedBy=multi-user.target
```

### 2. å¯åŠ¨å¹¶è®¾ç½®å¼€æœºè‡ªå¯ï¼š

```bash
sudo systemctl daemon-reexec
sudo systemctl daemon-reload
sudo systemctl start benork.service
sudo systemctl enable benork.service
```

---

## ğŸ§¾ æŸ¥çœ‹è¿è¡Œæƒ…å†µå’Œæ—¥å¿—ï¼š

```bash
sudo systemctl status benork.service
journalctl -u benork.service -n 50 --no-pager
journalctl -u benork.service -f  # å®æ—¶æ—¥å¿—
```

---

## ğŸŒ å¤–éƒ¨è®¿é—®æµ‹è¯•ï¼š

å‡è®¾æœåŠ¡å™¨å…¬ç½‘ IP ä¸º `1.2.3.4`ï¼Œå¯åœ¨æµè§ˆå™¨ä¸­è®¿é—®ï¼š

```
http://1.2.3.4:5002
```

ç¡®ä¿é˜²ç«å¢™å…è®¸ç«¯å£å¼€æ”¾ï¼š

```bash
sudo ufw allow 5002/tcp
```

---

å¦‚æœä½ è¿˜æœ‰å…¶ä»–æ¨¡å—ï¼ˆå¦‚ Neibrã€Galleryï¼‰ä¹Ÿç”¨ systemd ç®¡ç†ï¼Œæ¨èç»Ÿä¸€å‘½åè§„èŒƒï¼Œå¦‚ï¼š

```
neibr.service
gallery.service
benork.service
```

å¯æ‰¹é‡æŸ¥çœ‹çŠ¶æ€ï¼š

```bash
systemctl list-units --type=service | grep .service
```


æœªæ¥ä¸ºäº†ä¿è¯ä»£ç çš„ç»“æ„æ€§å’Œå¯æ‹“å±•æ€§ï¼Œæˆ‘å°†å–æ¶ˆadminï¼Œå°†è¿™éƒ¨åˆ†ä»£ç èåˆè‡³ç°åœ¨çš„mainï¼Œç„¶åå°†èåˆåçš„æ¨¡å—æ”¹åä¸ºmoneyï¼Œæœªæ¥å¦‚æœæœ‰æ–°çš„è¡¨å•ï¼Œåˆ™åœ¨ç°åœ¨moneyå’Œtutoringçš„åŸºç¡€ä¸Šå†æ·»åŠ æ–°çš„æ¨¡å—ã€‚